# Data Engineer MVP

Проект «Data Engineer MVP» — веб-сервис для анализа структур данных и генерации ETL-пайплайнов.

## Описание

Сервис позволяет:
- Загрузить данные (CSV, JSON, XML) или подключиться к источнику (Postgres/ClickHouse).
- На основе первых строк данных LLM рекомендует целевую СУБД, структуру хранения, генерирует ETL-пайплайн (Airflow DAG), DDL-скрипт и краткий бизнес-отчёт.
- Пользователь может просмотреть рекомендации, подтвердить загрузку в выбранную СУБД, скачать отчёт/DDL.
- Можно управлять списком созданных пайплайнов (просмотр, загрузка, удаление).

## Требования

- Python 3.9+
- Node.js (для React-фронтенда)
- Docker и Docker Compose (для контейнеризации)

## Локальный запуск

1. Установите зависимости:

```
pip install -r backend/requirements.txt
```

2. Запустите бэкенд:

```
python run.py
```

Бэкенд будет доступен по адресу `http://localhost:8000`.

3. Запустите фронтенд:

```
cd frontend
yarn install
yarn start
```

Фронтенд доступен по адресу `http://localhost:3000`.

## Запуск через Docker

1. Установите Docker и Docker Compose.
2. Запустите в корне проекта:

```
./rundocker
```

или

```
docker-compose up --build -d
```

3. Откройте в браузере:
- Фронтенд: `http://localhost:3000`
- FastAPI (API): `http://localhost:8000`
- Airflow: `http://localhost:8080`
- HDFS NameNode UI: `http://localhost:9870`

## Использование

- Загрузите тестовый файл: `data/sample.csv`, `data/sample.json` или свой файл.
- Во фронтенде выберите файл и нажмите «Анализировать и создать пайплайн».
- В разделе «Список пайплайнов» будет отображён созданный пайплайн. Нажмите «Загрузить в БД» для выполнения ETL, «Сформировать гипотезу» для генерации отчёта.

## Структура проекта

- `run.py` — запуск FastAPI.
- `rundocker` — скрипт для Docker.
- `docker-compose.yml` — сервисы: backend, frontend, Airflow, ClickHouse, PostgreSQL, HDFS.
- `backend/` — FastAPI приложение (логика, модели, utils).
- `frontend/` — React приложение (интерфейс).
- `prompts/` — шаблоны промтов для LLM.
- `data/` — пример данных для тестирования.
- `tests/` — тесты PyTest.

## Тестирование

```
pytest
```

## Примечания

- По умолчанию метаданные сохраняются в SQLite `backend.db`. Можно переключиться на PostgreSQL, изменив строку подключения в `backend/database.py`.
- Для HDFS используется single-node кластер на базе образов BDE. Сырые файлы рекомендуется складывать в `/data/raw`.


